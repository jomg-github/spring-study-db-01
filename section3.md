# 스프링 DB 1편 - 데이터 접근 핵심 원리

## 섹션3 - 커넥션풀과 데이터 소스 이해

---

### DB 커넥션 획득
1. 스프링 애플리케이션의 DB 드라이버를 통해 커넥션을 조회
2. DB 드라이버는 DB와 TCP/IP 연결 (3way-handshake)
3. DB 드라이버는 TCP/IP 연결 후, ID와 PW 등 커넥션 정보를 DB에 전달
4. DB는 인증을 완료 후, 내부에 DB 세션을 생성
5. DB는 커넥션 생성이 완료됐다는 응답을 보냄
6. DB 드라이버는 커넥션 객체를 생성해서 클라이언트에 반환

=> 복잡하고 시간도 많이 소모

<br/>

### 커넥션 풀

- 위 문제를 해결하기 위해 커넥션을 미리 생성해두고 사용하는 방법
- 커넥션이 미리 연결이 돼있는 상태기 때문에 SQL만 전달하면 됨
- 커넥션 사용 후, 커넥션을 종료하기 않고 살아있는 상태로 커넥션 풀이 반환
- DriverManager를 통해 커넥션을 획득하게 되면 항상 신규 커넥션을 생성함
- `commons-dbcp2`, `tomcat-jdbc pool`, `HikariCP` 등의 커넥션 풀 오픈소스
- 스프링부트 2.0부터는 `HikariCP`가 기본 커넥션 풀 


<br/>

### Datasource

- DriverManager와 커넥션 풀 오픈소스들은 커넥션을 획득하는 방법이 다름
- 이를 해결하기 위해 자바에서는 커넥션 조회를 추상화한 DataSource 인터페이스를 제공함
- 개발자는 커넥션 획득하는 방법은 상관없이 DataSource 인터페이스만 의존하면 됨